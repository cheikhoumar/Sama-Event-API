{"version":3,"file":"8-Dq7o1Vah.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/admin/event/_page.server.ts.js","../../../.svelte-kit/adapter-node/nodes/8.js"],"sourcesContent":["import { s as sendEventStatusNotification } from \"../../../../chunks/notification-sender.js\";\nimport { r as redirect } from \"../../../../chunks/index.js\";\nconst perPage = 20;\nconst load = async ({ url }) => {\n  const status = url.searchParams.get(\"status\");\n  const deleted = url.searchParams.get(\"deleted\");\n  const page = Number(url.searchParams.get(\"page\"));\n  const events = await prisma.event.findMany({\n    where: {\n      status: status ? status : void 0,\n      deletedAt: deleted === \"true\" ? { not: null } : null\n    },\n    include: { user: true },\n    skip: page * perPage,\n    take: perPage,\n    orderBy: { updatedAt: \"desc\" }\n  });\n  return { events, status, deleted, page };\n};\nconst actions = {\n  approve: async ({ request }) => {\n    const { selectedIds } = Object.fromEntries(await request.formData());\n    const eventIds = selectedIds ? selectedIds.split(\",\") : [];\n    await prisma.event.updateMany({\n      where: { id: { in: eventIds } },\n      data: { status: \"PUBLISHED\" }\n    });\n    sendNotifications(eventIds, \"PUBLISHED\");\n    redirect(303, \"/admin/event?status=PUBLISHED\");\n  },\n  reject: async ({ request }) => {\n    const { selectedIds } = Object.fromEntries(await request.formData());\n    const eventIds = selectedIds ? selectedIds.split(\",\") : [];\n    await prisma.event.updateMany({\n      where: { id: { in: eventIds } },\n      data: { status: \"REJECTED\" }\n    });\n    sendNotifications(eventIds, \"REJECTED\");\n    redirect(303, \"/admin/event?status=REJECTED\");\n  }\n};\nasync function sendNotifications(eventIds, status) {\n  const events = await prisma.event.findMany({\n    where: {\n      id: { in: eventIds },\n      status\n    },\n    select: { id: true, name: true, userId: true }\n  });\n  Promise.all(\n    events.map(\n      ({ id, name, userId }) => sendEventStatusNotification({\n        eventId: id,\n        userId,\n        eventName: name,\n        status\n      })\n    )\n  );\n}\nexport {\n  actions,\n  load\n};\n","import * as server from '../entries/pages/admin/event/_page.server.ts.js';\n\nexport const index = 8;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/pages/admin/event/_page.svelte.js')).default;\nexport { server };\nexport const server_id = \"src/routes/admin/event/+page.server.ts\";\nexport const imports = [\"_app/immutable/nodes/8.CVl2Y4Gb.js\",\"_app/immutable/chunks/scheduler.DFZBBKhI.js\",\"_app/immutable/chunks/index.LUCKkj9k.js\",\"_app/immutable/chunks/each.D6YF6ztN.js\",\"_app/immutable/chunks/entry.w9gK3Rx0.js\",\"_app/immutable/chunks/index.D8ci2SO2.js\",\"_app/immutable/chunks/control.CYgJF_JY.js\",\"_app/immutable/chunks/date-time.formatter.MppD4vc1.js\",\"_app/immutable/chunks/bundle-mjs.CuhWIVwh.js\",\"_app/immutable/chunks/Badge.XnCSpYGq.js\",\"_app/immutable/chunks/CloseButton.vrK9mPVw.js\",\"_app/immutable/chunks/Frame.DNz3Vx4g.js\",\"_app/immutable/chunks/BreadcrumbItem.ByMeSVu4.js\",\"_app/immutable/chunks/Button.CrNIN95s.js\",\"_app/immutable/chunks/Checkbox.8zBQxmcH.js\",\"_app/immutable/chunks/Label.CF2lxgNY.js\",\"_app/immutable/chunks/ExclamationCircleOutline.C-zkacHp.js\",\"_app/immutable/chunks/Pagination.BqOkK-u1.js\",\"_app/immutable/chunks/A.DUGD9iSR.js\",\"_app/immutable/chunks/Heading.BXZJ_QtE.js\",\"_app/immutable/chunks/P.CQZbmQ1E.js\",\"_app/immutable/chunks/CalendarMonthSolid.7F4bqAa3.js\",\"_app/immutable/chunks/CheckSolid.BTWMbPVw.js\"];\nexport const stylesheets = [];\nexport const fonts = [];\n"],"names":[],"mappings":"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"}